<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PromptPilot â€” Next Problem?</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div id="app">

    <!-- â”€â”€ Sidebar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <aside id="sidebar">
      <div id="sidebar-header">
        <div class="logo-row">
          <div class="logo-icon">ğŸ§­</div>
          <div>
            <div class="logo-text">PromptPilot</div>
            <div class="logo-sub">by Next Problem?</div>
          </div>
        </div>
      </div>

      <nav id="nav">
        <div class="nav-label">PREPARE</div>
        <div class="nav-item active" data-panel="prompts"><span class="nav-icon">ğŸ’¡</span> Prompts</div>
        <div class="nav-item" data-panel="ai"><span class="nav-icon">ğŸ¤–</span> AI Coach</div>
        <div class="nav-item" data-panel="practice"><span class="nav-icon">ğŸ™ï¸</span> Practice</div>
        <div class="nav-item" data-panel="jobs"><span class="nav-icon">ğŸ’¼</span> Job Analyzer</div>
        <div class="nav-label">MANAGE</div>
        <div class="nav-item" data-panel="history"><span class="nav-icon">ğŸ“š</span> History</div>
        <div class="nav-item" data-panel="vault"><span class="nav-icon">ğŸ—„ï¸</span> Resume Vault</div>
        <div class="nav-item" data-panel="audio"><span class="nav-icon">ğŸ§</span> Audio / Train</div>
        <div class="nav-label">SECURITY</div>
        <div class="nav-item" data-panel="profiles"><span class="nav-icon">ğŸ‘¤</span> Profiles</div>
        <div class="nav-item" data-panel="admin"><span class="nav-icon">ğŸ”</span> Admin</div>
        <div class="nav-item" data-panel="logs"><span class="nav-icon">ğŸ“‹</span> Audit Log</div>
        <div class="nav-item" data-panel="settings"><span class="nav-icon">âš™ï¸</span> Settings</div>
      </nav>

      <div id="sidebar-footer">
        <div style="display:flex;align-items:center;gap:8px;margin-bottom:6px">
          <div class="status-dot" id="ollama-dot" style="background:var(--text-muted);box-shadow:none"
            title="Ollama status"></div>
          <span id="ollama-label" style="font-size:11px;color:var(--text-muted)">Ollama offline</span>
        </div>
        <span class="version-badge">v1.2.0</span>
      </div>
    </aside>

    <!-- â”€â”€ Main â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div id="main">
      <div id="topbar">
        <h2 id="topbar-title">ğŸ’¡ Prompt Library</h2>
        <div class="topbar-right">
          <button class="btn-sm" id="check-ollama-btn" style="font-size:11px">ğŸ”„ Check Ollama</button>
        </div>
      </div>

      <div id="content">

        <!-- â”€â”€ PROMPTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="panel active" id="panel-prompts">
          <div class="card">
            <div class="card-title"><span>ğŸ’¡</span> Browse Prompt Templates</div>
            <div class="prompt-cats" id="cat-pills"></div>
            <div class="prompt-list" id="prompt-list"></div>
          </div>
          <div class="card" id="prompt-detail-card" style="display:none">
            <div class="card-title"><span>ğŸ“</span> Selected Prompt</div>
            <div class="form-row" style="margin-bottom:12px">
              <div class="field"><label>Title</label><input id="prompt-detail-title" readonly /></div>
              <div class="field"><label>Style</label><input id="prompt-detail-style" readonly /></div>
            </div>
            <div class="field"><label>Prompt Body</label>
              <textarea id="prompt-detail-body" rows="7" readonly></textarea>
            </div>
            <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
              <button class="btn-primary" id="copy-prompt-btn">ğŸ“‹ Copy</button>
              <button class="btn-success" id="goto-ai-btn">ğŸ¤– Generate AI Answer â†’</button>
            </div>
          </div>
        </div>

        <!-- â”€â”€ AI COACH â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="panel" id="panel-ai">
          <div class="card">
            <div class="card-title"><span>ğŸ¤–</span> AI Answer Generator</div>
            <p class="hint-text">Select a prompt from the library, add your context from the Resume Vault, then generate
              a personalized answer.</p>
            <div class="form-row">
              <div class="field"><label>Prompt / Question</label>
                <input id="ai-question" placeholder="Paste or type the interview questionâ€¦" />
              </div>
              <div class="field"><label>Answer Style</label>
                <select id="ai-style">
                  <option value="STAR">STAR</option>
                  <option value="QUANT">Quant Bullets</option>
                  <option value="HYBRID">Hybrid</option>
                </select>
              </div>
            </div>
            <div class="field" style="margin-top:10px">
              <label>Your Context (auto-filled from RAG, or type manually)</label>
              <textarea id="ai-context" rows="4"
                placeholder="Paste relevant experience, project details, metricsâ€¦"></textarea>
            </div>
            <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
              <button class="btn-primary" id="ai-generate-btn" style="gap:8px">ğŸ¤– Generate Answer</button>
              <button id="ai-rag-btn" style="gap:8px">ğŸ” Fetch RAG Context</button>
            </div>
          </div>

          <div class="card" id="ai-result-card" style="display:none">
            <div class="card-title"><span>âœ¨</span> Generated Answer</div>
            <div class="output-box" id="ai-output" style="min-height:120px;color:var(--text)"></div>
            <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
              <button class="btn-primary" id="ai-save-btn">ğŸ’¾ Save to History</button>
              <button id="ai-score-btn">ğŸ“Š Score this Answer</button>
              <button id="ai-copy-btn">ğŸ“‹ Copy</button>
              <button id="ai-practice-btn">ğŸ™ï¸ Practice with this â†’</button>
            </div>
          </div>

          <div class="card" id="ai-score-card" style="display:none">
            <div class="card-title"><span>ğŸ“Š</span> AI Score</div>
            <div id="score-overall" style="font-size:36px;font-weight:900;margin-bottom:8px;color:var(--accent)"></div>
            <div class="score-dims" id="score-dims"></div>
            <div style="margin-top:12px" id="score-feedback"></div>
          </div>
        </div>

        <!-- â”€â”€ PRACTICE MODE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="panel" id="panel-practice">
          <div class="card">
            <div class="card-title"><span>ğŸ™ï¸</span> Practice Mode</div>
            <p class="hint-text">Speak your answer aloud. The timer targets 2 minutes. Your speech is transcribed live,
              then scored by AI.</p>
            <div class="field"><label>Question to Practice</label>
              <input id="prac-question" placeholder="Paste the interview questionâ€¦" />
            </div>
            <div style="display:flex;align-items:center;gap:16px;margin-top:14px;flex-wrap:wrap">
              <div class="timer-display" id="prac-timer">2:00</div>
              <div style="display:flex;gap:10px;flex-wrap:wrap">
                <button class="btn-primary" id="prac-start-btn">ğŸ™ï¸ Start Recording</button>
                <button id="prac-stop-btn" disabled>â¹ï¸ Stop</button>
                <button id="prac-reset-btn">ğŸ”„ Reset</button>
              </div>
              <div class="badge badge-amber" id="prac-status">Ready</div>
            </div>
            <div class="field" style="margin-top:14px">
              <label>Live Transcript (auto-fill as you speak)</label>
              <textarea id="prac-transcript" rows="6"
                placeholder="Start recording â€” your speech appears hereâ€¦"></textarea>
            </div>
            <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
              <button class="btn-success" id="prac-score-btn">ğŸ“Š Score my Answer</button>
              <button id="prac-save-btn">ğŸ’¾ Save to History</button>
            </div>
          </div>

          <div class="card" id="prac-score-card" style="display:none">
            <div class="card-title"><span>ğŸ“Š</span> Practice Score</div>
            <div id="prac-score-overall" style="font-size:36px;font-weight:900;color:var(--accent);margin-bottom:10px">
            </div>
            <div id="prac-score-dims"></div>
            <div id="prac-score-feedback" style="margin-top:12px"></div>
          </div>
        </div>

        <!-- â”€â”€ JOB ANALYZER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="panel" id="panel-jobs">
          <div class="card">
            <div class="card-title"><span>ğŸ’¼</span> Job Description Analyzer</div>
            <p class="hint-text">Paste a full job description. The AI extracts key competencies, generates likely
              interview questions, and gives preparation tips.</p>
            <div class="field">
              <label>Job Description</label>
              <textarea id="jd-input" rows="10" placeholder="Paste the full job description hereâ€¦"></textarea>
            </div>
            <div style="display:flex;gap:10px;margin-top:12px">
              <button class="btn-primary" id="jd-analyze-btn">ğŸ” Analyze JD</button>
            </div>
          </div>

          <div id="jd-results" style="display:none">
            <div class="card">
              <div class="card-title"><span>ğŸ¯</span> Role Overview</div>
              <div class="form-row-3" id="jd-overview"></div>
            </div>
            <div class="card">
              <div class="card-title"><span>ğŸ†</span> Key Competencies</div>
              <div id="jd-competencies" class="tag-cloud"></div>
            </div>
            <div class="card">
              <div class="card-title"><span>â“</span> Likely Interview Questions</div>
              <div id="jd-questions" class="prompt-list"></div>
            </div>
            <div class="card">
              <div class="card-title"><span>ğŸ’¡</span> Preparation Tips & Culture</div>
              <div class="form-row" id="jd-tips-culture"></div>
            </div>
          </div>
        </div>

        <!-- â”€â”€ HISTORY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="panel" id="panel-history">
          <div class="card">
            <div class="card-title"><span>ğŸ“š</span> Saved Answers</div>
            <div style="display:flex;gap:10px;margin-bottom:14px;flex-wrap:wrap">
              <button id="hist-all-btn" class="cat-pill active">All</button>
              <button id="hist-fav-btn" class="cat-pill">â­ Favourites</button>
              <button id="hist-refresh-btn" class="btn-sm">ğŸ”„ Refresh</button>
              <button id="hist-clear-btn" class="btn-sm btn-danger">ğŸ—‘ï¸ Clear All</button>
            </div>
            <div id="history-list"></div>
          </div>
        </div>

        <!-- â”€â”€ RESUME VAULT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="panel" id="panel-vault">
          <div class="card">
            <div class="card-title"><span>ğŸ—„ï¸</span> Ingest New Document</div>
            <p class="hint-text">Paste your resume, LinkedIn About, project descriptions, or any text you want the AI to
              reference when generating answers.</p>
            <div class="field"><label>Document Name</label>
              <input id="vault-name" placeholder="e.g. My Resume, Project Notes, LinkedIn Aboutâ€¦" />
            </div>
            <div class="field"><label>Content (paste text)</label>
              <textarea id="vault-content" rows="10"
                placeholder="Paste your resume text, project descriptions, achievementsâ€¦"></textarea>
            </div>
            <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
              <button class="btn-primary" id="vault-ingest-btn">ğŸ“¥ Ingest Document</button>
            </div>
            <div class="output-box" id="vault-out" style="margin-top:12px;display:none"></div>
          </div>

          <div class="card">
            <div class="card-title"><span>ğŸ“</span> Ingested Documents</div>
            <div id="vault-doc-list" style="display:flex;flex-direction:column;gap:8px"></div>
            <button id="vault-refresh-btn" class="btn-sm" style="margin-top:12px">ğŸ”„ Refresh</button>
          </div>

          <div class="card">
            <div class="card-title"><span>ğŸ”</span> Test Retrieval</div>
            <div style="display:flex;gap:10px">
              <input id="vault-test-query" placeholder="Ask something about your backgroundâ€¦" style="flex:1" />
              <button id="vault-test-btn">ğŸ” Retrieve</button>
            </div>
            <div id="vault-test-out" style="margin-top:12px;display:flex;flex-direction:column;gap:8px"></div>
          </div>
        </div>

        <!-- â”€â”€ AUDIO / TRAINING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="panel" id="panel-audio">
          <div class="card">
            <div class="card-title"><span>ğŸ§</span> Audio Datasets</div>
            <p class="hint-text">Download curated speech datasets to fine-tune a local Whisper model for better
              interview speech recognition.</p>
            <div id="dataset-list" style="display:flex;flex-direction:column;gap:12px;margin-top:4px"></div>
          </div>

          <div class="card">
            <div class="card-title"><span>ğŸ§ </span> Whisper Fine-Tuning</div>
            <p class="hint-text">After downloading a dataset, run the scaffold script to fine-tune
              <code>openai/whisper-small</code> on your data.</p>
            <div class="output-box" style="color:var(--text-dim);font-size:12px">
              # Prerequisites
              pip install transformers datasets accelerate librosa

              # Fine-tune (from project root)
              python scripts/whisper_finetune.py \
              --dataset_name mozilla-foundation/common_voice_13_0 \
              --language en \
              --model_name openai/whisper-small \
              --output_dir ./models/whisper-interview \
              --num_epochs 3 \
              --batch_size 8
            </div>
            <div style="margin-top:12px;display:flex;gap:10px">
              <button id="copy-train-cmd-btn" class="btn-sm">ğŸ“‹ Copy Command</button>
            </div>
          </div>

          <div class="card">
            <div class="card-title"><span>ğŸ”§</span> Ollama Model Management</div>
            <p class="hint-text">Pull recommended models for interview coaching.</p>
            <div id="ollama-model-list" style="display:flex;flex-direction:column;gap:8px"></div>
            <div class="output-box" style="margin-top:14px;font-size:12px;color:var(--text-dim)">
              # Install Ollama, then pull models:
              ollama pull mistral
              ollama pull nomic-embed-text
              ollama pull llama3
              ollama pull codellama # for technical interviews
            </div>
          </div>
        </div>

        <!-- â”€â”€ PROFILES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="panel" id="panel-profiles">
          <div class="card">
            <div class="card-title"><span>âœ¨</span> Create New Profile</div>
            <div class="form-row-3">
              <div class="field"><label>User ID</label><input id="uid" placeholder="e.g. alice" /></div>
              <div class="field"><label>Display Name</label><input id="name" placeholder="Alice Smith" /></div>
              <div class="field"><label>Passphrase</label><input id="pw" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" /></div>
            </div>
            <div style="margin-top:14px">
              <button class="btn-primary" id="create_profile">âœ¨ Create Profile</button>
            </div>
            <div id="create_out" class="output-box" style="margin-top:14px;display:none"></div>
          </div>
          <div class="card">
            <div class="card-title"><span>ğŸ‘¥</span> Existing Profiles</div>
            <div class="profile-grid" id="profile-grid">
              <div style="color:var(--text-muted);font-size:13px">No profiles yet.</div>
            </div>
            <button id="refresh-profiles" class="btn-sm" style="margin-top:12px">ğŸ”„ Refresh</button>
          </div>
        </div>

        <!-- â”€â”€ ADMIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="panel" id="panel-admin">
          <div class="card">
            <div class="card-title"><span>ğŸ”</span> Admin Authentication</div>
            <div id="admin-status-banner" class="admin-locked">
              ğŸ”’ &nbsp;Admin mode is <strong>locked</strong>.
            </div>
            <div style="margin-top:14px;display:flex;gap:10px;flex-wrap:wrap">
              <button id="admin_nonce">ğŸ² Get Nonce</button>
              <button id="admin_status">ğŸ” Check Status</button>
            </div>
            <div class="field" style="margin-top:14px"><label>Nonce</label>
              <div class="output-box" id="nonce-display">
                <span class="output-empty">Click "Get Nonce"â€¦</span>
              </div>
            </div>
            <div style="display:flex;gap:10px;margin-top:12px">
              <input id="sig" placeholder="base64(Ed25519 signature of nonce)" style="flex:1" />
              <button class="btn-primary" id="admin_unlock">ğŸ”“ Unlock</button>
            </div>
            <div id="admin_out" class="output-box" style="margin-top:12px;display:none"></div>
          </div>
          <div class="card">
            <div class="card-title"><span>ğŸ¤</span> Consent Flow</div>
            <div class="form-row">
              <div class="field"><label>User ID</label><input id="c_user" placeholder="user id" /></div>
              <div style="display:flex;align-items:flex-end">
                <button class="btn-primary" id="req_consent">ğŸ“© Request Consent</button>
              </div>
            </div>
            <div class="output-box" id="consent_out" style="margin-top:12px"><span class="output-empty">Outputâ€¦</span>
            </div>
            <div class="form-row" style="margin-top:12px">
              <div class="field"><label>Consent Nonce</label><input id="consent_nonce" /></div>
              <div class="field"><label>User Sig (base64)</label><input id="user_sig" /></div>
            </div>
            <div class="field" style="margin-top:10px"><label>User Pubkey (base64)</label><input id="user_pub" /></div>
            <div style="margin-top:12px"><button class="btn-success" id="verify_consent">âœ… Verify &amp;
                Authorize</button></div>
            <div id="verify_out" class="output-box" style="margin-top:10px;display:none"></div>
          </div>
        </div>

        <!-- â”€â”€ LOGS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="panel" id="panel-logs">
          <div class="card">
            <div class="card-title"><span>â•</span> Append Event</div>
            <div style="display:flex;gap:10px">
              <input id="log_event" placeholder="Describe the eventâ€¦" style="flex:1" />
              <button class="btn-primary" id="append_log">â• Append</button>
              <button id="log_head">ğŸ”— Head Hash</button>
            </div>
            <div class="output-box" id="log_out" style="margin-top:12px;display:none"></div>
          </div>
          <div class="card">
            <div class="card-title"><span>ğŸ“‹</span> Recent Log Entries</div>
            <div class="table-wrap">
              <table class="log-table">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>Timestamp</th>
                    <th>Event</th>
                    <th>Prev Hash</th>
                    <th>Curr Hash</th>
                  </tr>
                </thead>
                <tbody id="log-table-body">
                  <tr>
                    <td colspan="5" style="text-align:center;color:var(--text-muted);padding:20px">No entries</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <button id="refresh-logs" class="btn-sm" style="margin-top:12px">ğŸ”„ Refresh</button>
          </div>
        </div>

        <!-- â”€â”€ SETTINGS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="panel" id="panel-settings">
          <div class="card">
            <div class="card-title"><span>ğŸ¤–</span> AI Model Settings</div>
            <div class="form-row">
              <div class="field"><label>Generation Model (Ollama)</label>
                <input id="gen-model" value="mistral" placeholder="mistral" />
              </div>
              <div class="field"><label>Embedding Model (Ollama)</label>
                <input id="embed-model" value="nomic-embed-text" placeholder="nomic-embed-text" />
              </div>
            </div>
            <p style="color:var(--text-muted);font-size:12px;margin-top:8px">
              Changes apply immediately â€” no save needed. Install models with:
              <code style="color:var(--cyan)">ollama pull mistral && ollama pull nomic-embed-text</code>
            </p>
          </div>
          <div class="card">
            <div class="card-title"><span>âš™ï¸</span> Answer Style Default</div>
            <div class="form-row" style="max-width:420px">
              <div class="field"><label>Default Style</label>
                <select id="style">
                  <option value="STAR">STAR</option>
                  <option value="QUANT">Quant Bullets</option>
                  <option value="HYBRID">Hybrid</option>
                </select>
              </div>
              <div style="display:flex;align-items:flex-end">
                <button class="btn-primary" id="save_style">ğŸ’¾ Save</button>
              </div>
            </div>
            <div id="style_out" class="output-box" style="margin-top:12px;display:none"></div>
          </div>
          <div class="card">
            <div class="card-title"><span>ğŸ”‘</span> Unlock Profile</div>
            <div class="form-row">
              <div class="field"><label>User ID</label><input id="unlock-uid" placeholder="user id" /></div>
              <div class="field"><label>Passphrase</label><input id="unlock-pw" type="password"
                  placeholder="passphrase" /></div>
            </div>
            <div style="margin-top:12px"><button class="btn-primary" id="unlock-btn">ğŸ”‘ Unlock</button></div>
            <div id="unlock_out" class="output-box" style="margin-top:10px;display:none"></div>
          </div>
          <div class="card">
            <div class="card-title"><span>â„¹ï¸</span> About</div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;font-size:13px">
              <div><span style="color:var(--text-muted)">App</span><br /><strong>PromptPilot</strong></div>
              <div><span style="color:var(--text-muted)">Version</span><br /><strong>1.2.0</strong></div>
              <div><span style="color:var(--text-muted)">AI Engine</span><br /><strong>Ollama (local)</strong></div>
              <div><span style="color:var(--text-muted)">RAG</span><br /><strong>SQLite + Cosine Similarity</strong>
              </div>
              <div><span style="color:var(--text-muted)">Crypto</span><br /><strong>Ed25519 + XChaCha20</strong></div>
              <div><span style="color:var(--text-muted)">Storage</span><br /><strong>SQLite (all local)</strong></div>
            </div>
            <div style="margin-top:14px">
              <a href="assets/brand.html" target="_blank"
                style="color:var(--accent);font-size:13px;text-decoration:none">ğŸ¬ View installer animation â†’</a>
            </div>
          </div>
        </div>

      </div><!-- #content -->
    </div><!-- #main -->
  </div><!-- #app -->

  <div id="toast-container"></div>
  <script src="main.js"></script>
</body>

</html>